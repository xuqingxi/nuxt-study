{"version":3,"file":"1.js","sources":["webpack:///./utils/common.js","webpack:///./api/article.js","webpack:///./pages/home/index.vue?e79c","webpack:///./pages/home/index.vue?bcc2","webpack:///./pages/home/index.vue?16af","webpack:///./pages/home/index.vue?5d5c","webpack:///./api/home.js","webpack:///./pages/home/index.vue","webpack:///./pages/home/index.vue?764d","webpack:///./pages/home/index.vue?c145"],"sourcesContent":["export function objToQueryStr(obj) {\r\n  if (typeof obj != 'object') return\r\n  let queryStr = ''\r\n  for(let key in obj) {\r\n    if(obj[key] && obj[key] != 0)\r\n    queryStr += key + '=' + obj[key] + '&'\r\n  }\r\n  return queryStr.slice(0, -1)\r\n}","import { api } from '../plugins/request'\r\nimport { objToQueryStr } from '../utils/common'\r\n\r\n// 获取关注文章\r\nexport async function getFeedArticles(params) {\r\n  params = objToQueryStr(params)\r\n  return api.get(`/articles/feed?${params}`)\r\n            .then(data => {\r\n              return [null, data]\r\n            })\r\n            .catch(err => {\r\n              return [err]\r\n            })\r\n}\r\n\r\n// 获取所有文章\r\nexport async function getGlobalArticles(params) {\r\n  params = objToQueryStr(params)\r\n  return api.get(`/articles?${params}`)\r\n            .then(data => {\r\n              return [null, data]\r\n            })\r\n            .catch(err => {\r\n              return [err]\r\n            })\r\n}\r\n\r\n// 生成文章\r\nexport async function createArticle(params) {\r\n  return api.post(`/articles`, params)\r\n            .then(data => {\r\n              return [null, data]\r\n            })\r\n            .catch(err => {\r\n              return [err]\r\n            })\r\n}\r\n\r\n// 获取文章\r\nexport async function getArticle(slug) {\r\n  return api.get(`/articles/${slug}`)\r\n            .then(data => {\r\n              return [null, data]\r\n            })\r\n            .catch(err => {\r\n              return [err]\r\n            })\r\n}\r\n\r\n// 更新文章\r\nexport async function updateArticle(slug, params) {\r\n  return api.update(`/articles/${slug}`, params)\r\n            .then(data => {\r\n              return [null, data]\r\n            })\r\n            .catch(err => {\r\n              return [err]\r\n            })\r\n}\r\n\r\n// 删除文章\r\nexport async function deleteArticle(slug) {\r\n  return api.delete(`/articles/${slug}`)\r\n            .then(data => {\r\n              return [null, data]\r\n            })\r\n            .catch(err => {\r\n              return [err]\r\n            })\r\n}\r\n\r\n// 获取文章评论\r\nexport async function getArticleComments(slug) {\r\n  return api.get(`/articles/${slug}/comments`)\r\n            .then(data => {\r\n              return [null, data]\r\n            })\r\n            .catch(err => {\r\n              return [err]\r\n            })\r\n}\r\n\r\n// 生成文章评论\r\nexport async function createArticleComment(slug, params) {\r\n  return api.post(`/articles/${slug}/comments`, params)\r\n            .then(data => {\r\n              return [null, data]\r\n            })\r\n            .catch(err => {\r\n              return [err]\r\n            })\r\n}\r\n\r\n// 删除文章评论\r\nexport async function deleteArticleComment(slug, id) {\r\n  return api.delete(`/articles/${slug}/comments/${id}`)\r\n            .then(data => {\r\n              return [null, data]\r\n            })\r\n            .catch(err => {\r\n              return [err]\r\n            })\r\n}","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js??ref--3-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--3-oneOf-1-2!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=2d32b210&scoped=true&lang=css&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add CSS to SSR context\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesServer.js\").default\nmodule.exports.__inject__ = function (context) {\n  add(\"3b788284\", content, true, context)\n};","export * from \"-!../../node_modules/vue-style-loader/index.js??ref--3-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--3-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--3-oneOf-1-2!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=2d32b210&scoped=true&lang=css&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/css-loader/dist/runtime/api.js\");\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(false);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".page-split[data-v-2d32b210]{display:flex;width:100%;flex-wrap:wrap;align-items:center;box-sizing:border-box}.page-btn[data-v-2d32b210]{height:20px;line-height:19px;padding:0 5px;border:1px solid;text-align:center}.active-btn[data-v-2d32b210]{background:#5cb85c;border:1px solid #5cb85c;color:#fff}\", \"\"]);\n// Exports\nmodule.exports = ___CSS_LOADER_EXPORT___;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"home-page\"},[_vm._ssrNode(\"<div class=\\\"banner\\\" data-v-2d32b210><div class=\\\"container\\\" data-v-2d32b210><h1 class=\\\"logo-font\\\" data-v-2d32b210>conduit</h1> <p data-v-2d32b210>A place to share your knowledge.</p></div></div> \"),_vm._ssrNode(\"<div class=\\\"container page\\\" data-v-2d32b210>\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"row\\\" data-v-2d32b210>\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"col-md-9\\\" data-v-2d32b210>\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"feed-toggle\\\" data-v-2d32b210>\",\"</div>\",[_vm._ssrNode(\"<ul class=\\\"nav nav-pills outline-active\\\" data-v-2d32b210>\",\"</ul>\",[(_vm.hasLogin)?_vm._ssrNode(\"<li class=\\\"nav-item\\\" data-v-2d32b210>\",\"</li>\",[_c('nuxt-link',{staticClass:\"nav-link\",class:{\n                  'active': _vm.$route.query.type == 'feed'\n                },attrs:{\"to\":{\n                  name: 'home',\n                  query: {\n                    limit: 20,\n                    offset: 0,\n                    type: 'feed'\n                  }\n                }}},[_vm._v(\"Your Feed\")])],1):_vm._e(),_vm._ssrNode(\" \"),_vm._ssrNode(\"<li class=\\\"nav-item\\\" data-v-2d32b210>\",\"</li>\",[_c('nuxt-link',{staticClass:\"nav-link\",class:{\n                  'active': (!_vm.$route.query.type && !_vm.$route.query.tag) || _vm.$route.query.type == 'global'\n                },attrs:{\"to\":{\n                  name: 'home',\n                  query: {\n                    limit: 20,\n                    offset: 0,\n                    type: 'global'\n                  }\n                }}},[_vm._v(\"Global Feed\")])],1),_vm._ssrNode(\" \"),(_vm.$route.query.tag)?_vm._ssrNode(\"<li class=\\\"nav-item\\\" data-v-2d32b210>\",\"</li>\",[_c('nuxt-link',{staticClass:\"nav-link\",class:{\n                  'active': _vm.$route.query.tag\n                },attrs:{\"to\":{\n                  tag: _vm.$route.query.tag,\n                  limit: 20,\n                  offset: 0\n                }}},[_vm._v(\"#\"+_vm._s(_vm.$route.query.tag))])],1):_vm._e()],2)]),_vm._ssrNode(\" \"),_vm._l((_vm.articles),function(article){return _vm._ssrNode(\"<div class=\\\"article-preview\\\" data-v-2d32b210>\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"article-meta\\\" data-v-2d32b210>\",\"</div>\",[_c('nuxt-link',{attrs:{\"to\":{\n                name: 'profile'\n              }}},[_c('img',{attrs:{\"src\":article.author.image}})]),_vm._ssrNode(\" \"),_vm._ssrNode(\"<div class=\\\"info\\\" data-v-2d32b210>\",\"</div>\",[_c('nuxt-link',{staticClass:\"author\",attrs:{\"to\":{\n                name: 'profile'\n              }}},[_vm._v(_vm._s(article.author.username))]),_vm._ssrNode(\" <span class=\\\"date\\\" data-v-2d32b210>\"+_vm._ssrEscape(_vm._s(article.createdAt))+\"</span>\")],2),_vm._ssrNode(\" <button class=\\\"btn btn-outline-primary btn-sm pull-xs-right\\\" data-v-2d32b210><i class=\\\"ion-heart\\\" data-v-2d32b210></i>\"+_vm._ssrEscape(\" \"+_vm._s(article.favoritesCount)+\"\\n            \")+\"</button>\")],2),_vm._ssrNode(\" \"),_c('nuxt-link',{staticClass:\"preview-link\",attrs:{\"to\":{\n                name: 'profile'\n              }}},[_c('h1',[_vm._v(_vm._s(article.title))]),_vm._v(\" \"),_c('p',[_vm._v(_vm._s(article.description))]),_vm._v(\" \"),_c('span',[_vm._v(\"Read more...\")])])],2)})],2),_vm._ssrNode(\" \"),_vm._ssrNode(\"<div class=\\\"col-md-3\\\" data-v-2d32b210>\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"sidebar\\\" data-v-2d32b210>\",\"</div>\",[_vm._ssrNode(\"<p data-v-2d32b210>Popular Tags</p> \"),_vm._ssrNode(\"<div class=\\\"tag-list\\\" data-v-2d32b210>\",\"</div>\",_vm._l((_vm.tagList),function(tag){return _c('nuxt-link',{key:tag,staticClass:\"tag-pill tag-default\",attrs:{\"to\":{\n              name: 'home',\n              query: {\n                tag: tag,\n              }\n            }}},[_vm._v(_vm._s(tag))])}),1)],2)])],2),_vm._ssrNode(\" \"),_vm._ssrNode(\"<div class=\\\"page-split\\\" data-v-2d32b210>\",\"</div>\",_vm._l((_vm.totalPage),function(count){return _c('nuxt-link',{key:count,class:['page-btn', _vm.currentPage == count?'active-btn':''],attrs:{\"to\":{\n        name: 'home',\n        query: {\n          tag: _vm.$route.query.tag,\n          limit: 20,\n          offset: (count - 1) * 20\n        }\n      }}},[_vm._v(_vm._s(count))])}),1)],2)],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { api } from '../plugins/request'\r\n\r\n// 获取标签类别\r\nexport async function getTags() {\r\n  return api.get('/tags')\r\n            .then(data => {\r\n              return [null, data]\r\n            })\r\n            .catch(err => {\r\n              return [err]\r\n            })\r\n}","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { getTags } from '../../api/home'\r\nimport { getFeedArticles, getGlobalArticles } from '../../api/article'\r\nexport default {\r\n    name: 'HomeIndex',\r\n    data() {\r\n      return {\r\n        \r\n      }\r\n    },\r\n    watchQuery: ['tag', 'offset', 'type'],\r\n    async asyncData({query, store}) {\r\n      let pArr = [getTags(), getGlobalArticles(query)]\r\n      if(store.state.user) {\r\n        pArr.push(getFeedArticles(query))\r\n      }\r\n      let [tagRes, articleRes, feedRes] = await Promise.all(pArr)\r\n      let tagList = [], articles = []\r\n      let totalCount = 0\r\n      if(tagRes[1] && tagRes[1].tags) {\r\n        tagList = tagRes[1].tags.slice(0, 10)\r\n      }\r\n      if(articleRes[1] && articleRes[1].articles) {\r\n        articles = articleRes[1].articles\r\n        totalCount = articleRes[1].articlesCount\r\n      }\r\n      return {\r\n        tagList,\r\n        articles,\r\n        totalCount\r\n      }\r\n    },\r\n    methods: {\r\n    },\r\n    computed: {\r\n      hasLogin() {\r\n        return this.$store.state.user\r\n      },\r\n      totalPage() {\r\n        return Math.ceil(this.totalCount / (this.$route.query.limit || 20))\r\n      },\r\n      currentPage() {\r\n        return (this.$route.query.offset / this.$route.query.limit) + 1\r\n      }\r\n    }\r\n};\r\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=2d32b210&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  var style0 = require(\"./index.vue?vue&type=style&index=0&id=2d32b210&scoped=true&lang=css&\")\nif (style0.__inject__) style0.__inject__(context)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"2d32b210\",\n  \"6764f259\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;AAAA;AACA;;ACRA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;;;;;;;ACtGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACXA;AAAA;AAAA;AAAA;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AC5CA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;;;;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AAGA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAHA;AAKA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAVA;AA/BA;;AC1HA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}